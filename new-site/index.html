<html xmlns="http://www.w3.org/1999/xhtml">
<div class="viewport">
<meta name="viewport" content="width=device-width, initial-scale=1">
  <head>
    <link rel="stylesheet" type="text/css" href="../css/style.css"/>
  </head>
  <body>
    <div class="carousel">
      <ul id="scroll" class="scroll">
        <li class="scroll-item-outer">
          <div class="scroll-item scroll-item-padding" style="background-color:transparent">
          </div>
        </li>
        <li id="first-scroll-item" class="scroll-item-outer">
          <div class="scroll-item">
          </div>
        </li>
        <li class="scroll-item-outer">
          <div class="scroll-item">
          </div>
        </li>
        <li class="scroll-item-outer">
          <div class="scroll-item">
          </div>
        </li>
        <li class="scroll-item-outer">
          <div class="scroll-item">
          </div>
        </li>
        <li class="scroll-item-outer">
          <div class="scroll-item">
          </div>
        </li>
        <li class="scroll-item-outer">
          <div class="scroll-item">
          </div>
        </li>
        <li class="scroll-item-outer">
          <div class="scroll-item">
          </div>
        </li>
        <li id="last-scroll-item" class="scroll-item-outer">
          <div class="scroll-item">
          </div>
        </li>
        <li class="scroll-item-outer">
          <div class="scroll-item scroll-item-padding" style="background-color:transparent">
          </div>
        </li>
      </ul>
    </div>
  </div>
</body>
<script>(function() {
    function scrollListener(e) {
        e = window.event || e;
        var delta = Math.max(-1, Math.min(1, (e.wheelDelta || -e.detail)));
        if (scrollView.scrollLeft < firstItemPosition) {
          setTimeout(function () {
            scrollView.scrollTo(firstItemPosition, 0);
          },2);
        } else if(e.target.scrollLeft > lastItemPosition) {
          setTimeout(function () {
            scrollView.scrollTo(lastItemPosition, 0);
          },2);
        }
        var newSelected = Math.min(maxVisibleChildren,Math.max(1, Math.round(scrollView.scrollLeft/(firstItemPosition+100))));
        console.log(scrollView.scrollLeft);
        if (newSelected != selected) {
          console.log('updating ' + newSelected);
            scrollView.children[selected].children[0].classList.remove('selected-scroll-item');
            selected = newSelected;
            scrollView.children[selected].children[0].classList.add('selected-scroll-item');

        }
    }
    var scrollView = document.getElementById('scroll');
    var firstItemPosition = 231;
    var lastItemPosition = 2611;
    var newSelected = 1;
    var selected = 0;
    var maxVisibleChildren = scrollView.childElementCount - 2;

    if (scrollView.addEventListener) {
        // IE9, Chrome, Safari, Opera, Firefox
        scrollView.addEventListener("scroll", scrollListener, false);
        // Firefox
    } else {
        // IE 6/7/8
        scrollView.attachEvent("scroll", scrollListener);
    }
    scrollView.scrollTo(firstItemPosition, 0)
})();
</script>
</html>
